import { Canvas, Meta, Story } from '@storybook/blocks';

import * as KpiStories from './Kpi.stories';

# KPI

The Key Performance Indicator (KPI) component provides a compact representation when you need an overview of your asset properties. 
This overview provides critical insights into the overall performance of your devices, equipment, and processes. 
The KPI component lets you can interact with IoT data from one or more data sources.

<Canvas sourceState="none" story={{height : '70px' }} of={KpiStories.Standard} />

## KPI Properties

The KPI component contains the following customizable properties.

#### viewport (object, optional): 

This specifies the interval of time the widget visualizes. If not present, the widget utilizes the `viewport` specified by its [ViewportManager](/docs/components-viewportmanager--docs).
If a ViewportManager, and a `viewport` is not defined, the default value is `{ duration: '10d' }`.
Learn about the [viewport](/docs/core-viewport--docs).

#### thresholds (optional): 

A styled threshold defines rules that effect how the data is visualized. It's based on if the data breaches the threshold as well as how the threshold is styled.
Learn more about [thresholds](/docs/core-thresholds--docs#thresholds).

**timeZone** (string, optional): 

Timezone must be specified as an [IANA timezone string](https://ftp.iana.org/tz/tzdb-2020f/zone1970.tab). If this property is provided, the chart displays all dates in the provided timezone. If not provided, it uses the browsers local timezone.

#### query (object, optional): 

This query specifies the time series data to visualize. Learn more about [time series data queries](/docs/core-time-series-data--docs).

#### settings (object, optional): 

This specifies the settings to customize the appearance of the widget. The settings object contains the following properties:

  * `showTimestamp` (boolean, optional): Displays the timestamp of the data being displayed. Defaults to true.
  * `showAggregationAndResolution` (boolean, optional): Displays the ggregation and resolution of the data being displayed. Defaults to true.
  * `showName` (boolean, optional): Displays the name of the data being displayed. Defaults to true.
  * `showUnit` (boolean, optional): Displays the unit if present. Defaults to true.
  * `fontSize` (number, optional): Displays the font size in pixels for the value. Defaults to 30.
  * `secondaryFontSize` (number, optional): Displays the font size in pixels for the title. Defaults to 15.

  The following settings properties are deprecated:
  * `color` (string, optional): Specifies the color to display. Defaults to `black`. It is overriden by thresholds and alarms. The value must be a `css` string.
  * `showIcon`(boolean, optional): Display the icon if present. Defaults to true.
  * `aggregationFontSize` (number, optional): Display the font size in pixels for aggregation and resolution.

#### styles (object, optional): 

This contains a map of `refId` to style settings for the component. Learn more about [reference IDs](/docs/core-styles--docs).
It has the following style settings that are customizable:

  * `name` (string, optional): This specifies a name to replace the name of the data set given by its source.
  * `unit` (string, optional): This specifies the units for the data (for example, `"m/s"` and `"count"`).
  * `detailedName` (string, optional): This specifies the detailed name presented in the tooltip.

### Examples

```jsx
<KPI
  query={
    query.timeSeriesData({
      assets: [{
        assetId: 'id',
        properties: [{ propertyId: 'property', refId: 'my-property' }]
      }]
    })
 }

 styles={{ 'my-property': { name: 'My Cool Property' }}}
/>

```


<Meta of={KpiStories} />

Below are some examples of the KPI visualizations.

## Empty
<Canvas sourceState="none"   of={KpiStories.Empty} />

## Loading
<Canvas sourceState="none"  of={KpiStories.Loading} />

## Error
<Canvas sourceState="none"   of={KpiStories.Error} />
