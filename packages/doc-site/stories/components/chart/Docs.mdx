import { Canvas, Meta, Story } from '@storybook/blocks';

import * as ChartStories from './Chart.stories';

<Meta of={ChartStories} />

# Chart

The chart component is a way to visualize and navigate time series data from one or more [data sources](/docs/core-datasources--docs).

Chart supports a rich set of features including trend cursors, thresholds, high performance live-streaming and smooth syncing across other IoT App Kit components.

This component can be used to draw both line (step-up, step-down, step-mid etc.)and scatter charts

## Demo

<Canvas sourceState="none"  story={{height : '450px' }}  of={ChartStories.Standard} />

**ðŸ“ˆðŸ‘† Interact with the chart!**

**_Pan_**: hold shift, click and drag within the data-visualization area of the chart.

**_Zoom in_**: you can zoom in by scrolling up on the chart OR clicking on the zoom icon on the top tight corner of the chart and select the desired window.

**_Zoom out:_** you can zoom out by scrolling down on the chart.

**_Restrict time span_:** click on the zoom icon in the top right corner of the chart and drag through the interval of time you wish to restrict the viewport to.

**_Reset time span_:** click on the zoom reset icon in the top right corner of the chart.

**_Resize chart width_:** hold the divider between the chart and the legend section and move it horizontally.

**_Add a trend cursor_:** right click on the chart and click on Add trend cursor OR hold t key and click on the chart where you want a trend cursor

**_Delete a trend cursor_:** right click near a trend cursor(do not have to be exactly on the trend cursor line) and click on Delete trend cursor.

**_Copy a trend cursor's data_:** right click near a trend cursor(do not have to be exactly on the trend cursor line) and click on Copy trend cursor. The copied data is csv/excel compatible.

## Basic usage


```jsx
import { Chart } from '@iot-app-kit/react-components';

const Page = () => (
  <div>
    <Chart queries={[/** add your queries here *//]} />
  </div>
);
```

## Chart Properties

The chart component contains the following properties.


**queries** (array, required): The queries which specify the time series data to visualize. 
This is the only required property.[Learn more about time series data queries](/docs/core-time-series-data--docs).

**defaultVisualizationType**(type, optional): This property specifies the visualization type for the chart.
The type must be one of `'line' | 'bar' | 'scatter' | 'step-start' | 'step-middle' | 'step-end'`. Default is `line`.

**size** (object, optional): Specifies the height and width of the chart component. 
This includes the legend section when the legend section is selected. Example `{ width: Number, height: Number }`.
Default value is `{ width: 500, height: 500 }`.

**styleSettings** (object, optional): This groups all the styling options available for the chart by `refId`. 
[Learn more about reference IDs here](/docs/core-styles--docs).

  Properties:

  * `visualizationType` (optional): This is similar to the defaultVisualizationType field. 
  The type must be one of `'line' | 'bar' | 'scatter' | 'step-start' | 'step-middle' | 'step-end'`. Default value is `line`.

  * `color` ():

  * `symbol` (optional): This is the symbol style that marks the data points. The type must be one of 
  `'emptyCircle' | 'circle' | 'rect' | 'roundRect' | 'triangle' | 'diamond' | 'pin' | 'arrow' | 'none'`. Default value is `'circle'`.

  * `symbolColor` (string, optional): This specifies the symbol color. The value is a color name or a hex value. Default is `'none'`. 

  * `symbolSize` (number, optional): This specifies the symbol size. Default is `''`.

  * `lineStyle` (optional): This specifies the line style if `visualizationType` is not `scatter`. The type must be of
   one of `'solid' | 'dotted' | 'dashed'`. Default value is `'solid'`.

  * `lineThickness` (number, optional): This specifies the thickness of the line drawn between the data points. Default value is `''`.

  * `yAxis` (object, optional): This specifies y value and has the following properties.

    Properties:

      * `yAxisLabel` (string, optional): This specifies the label shown for the yAxis. Default value is `undefined`.
      * `yMin` (number, optional): This specifies the minimum value for the yAxis. The data below this value is hidden. Default value is `undefined`.
      * `yMax` (number, optional): This specifies the maximum value for the yAxis, the data above this value is hidden. Default value is `undefined`.

- `significantDigits`

  (Optional) this specifies the number of significant digits to be shown of the data

  Default value: `4`

  Type: Number

- `name`

  (Optional) this specifies the name of the property to be shown on the widget

  Default value: undefined

  Type: String


__Example usage__:

Simple way to set the color and name of the property in the line chart. This one will color the property red on the chart and display it as 'Demo Property'.

```jsx
<LineChart
  /** Specifying a query which provides a `refId` */
  queries={[
    query.timeSeriesData({ 
      assets: [{
        assetId: 'id', 
        properties: [{ propertyId: 'property', refId: 'my-property' }]
      }]
    })
 ]}
 
 /** Mapping the provided `refId` to the line chart style settings */
 styleSettings={{ 'my-property': { color: 'red', name: 'Demo Property' }}}
/>
```

Other styles such as data point symbols, line type, and significant digits of values can be customized. This style setting will display a 
dashed red line with rounded rectangle datapoints whose values are truncated to 5 significant digits for the property 'Demo Property'.

```jsx
const styleObject = { color: 'red', name: 'Demo Property', symbol: 'roundRect', lineStyle: 'dashed', significantDigits: 5 }

<LineChart
  /** Specifying a query which provides a `refId` */
  queries={[
    query.timeSeriesData({ 
      assets: [{
        assetId: 'id', 
        properties: [{ propertyId: 'property', refId: 'my-property' }]
      }]
    })
 ]}
 
 /** Mapping the provided `refId` to the line chart style settings */
 styleSettings={{ 'my-property': styleObject}}
/>
```


### `viewport`

(Optional) Specifies the interval of time the widget visualizes. If not provided, will utilize the `viewport` specified by its [ViewportManager](/docs/components-viewportmanager--docs).
If there is no ViewportManager, and no `viewport` defined, the default viewport will be `{ duration: '10s' }`.

[Learn about the viewport](/docs/core-viewport--docs).

Type: Object

### `thresholds`

(Optional) Thresholds define rules which effect how the data is visualized based on whether the data breaches the threshold.

[Learn more about thresholds](/docs/core-thresholds--docs#thresholds).

### `thresholdSettings`

(Optional) Customize settings on how thresholds are visualized within the widget. Defaults to `{ colorBreachedData: true }`

[Learn more about thresholds settings](/docs/core-thresholds--docs#thresholdsettings).

Type: Object


### `aggregationType`

(Optional) specifies the data aggregation window.

Default value: `undefined`

Type: String

### `gestures`

(Optional) Specifies whether gestures (pan, zoom and restrict time-span) are enabled. Defaults to `true`.

### `axis`

(Optional) Specifies x and y-axis related settings. Defaults to .

Default value: `{ showX: true, showY: true, yAxisLabel: undefined }`

__Example usage__:
```jsx
import { Chart } from '@iot-app-kit/react-components';
const otherFields = {};
<Chart axis={{ showX: false, showY: true }} {...otherFields} />
```

__Properties__:

- `showX`

  (Optional) Setting to determine whether we show the x-axis. Defaults to true.

  Type: Boolean

- `showY`

  (Optional) Setting to determine whether we show the y-axis and the horizontal grid lines. Defaults to true.

  Type: Boolean

- `yAxisLabel`

  (Optional) The y-axis label content. Defaults to empty.

  Type: String

### `backgroundColor`

(Optional) Specifies the background color of the chart.

Default value: `undefined`

Type: String

### `fontSettings`

(Optional) Specifies the chart's font color and font size.

Default value: `undefined`

__Properties__:

- `fontColor`
  (Optional) Specifies the chart's font color.

  Default value: `undefined`

  Type: String

- `fontSize`

  (Optional) Specifies the chart's font size.

  Default value: `undefined`

  Type: Number

### `significantDigits`

(Optional) this specifies the number of significant digits to be shown of the data

Default value: `4`

Type: Number


### `theme`

(Optional) this specifies either to use light or dark theme

Default value: `light`

Type: one of `'light' | 'dark'`


### `id`

(Optional) this specifies a **unique** id for the chart

Default value: `undefined`

Type: String


### `titleText`

(Optional) this specifies a title for the chart

Default value: `undefined`

Type: String



### `legend`

(Optional) Specifies the color and position of the legend section

Default value: `undefined`

__Properties__:

- `backgroundColor`

  (Optional) Specifies the background color of the legend sections, can be either a color name or its hex value.

  Default value: `'undefined'`

  Type: String



- `position[WIP]`

  (Optional) Specifies the position of the legend w.r.t the chart

  Default value: `'right'`

  Type: one of `'top' | 'bottom' | 'left', 'right'`
