import { Canvas, Meta, Story } from '@storybook/addon-docs';

import { useState, useCallback } from 'react';

import SceneViewer, { argTypes, args } from './../components/scene-viewer';

<Meta title="Tests/Scene Viewer/Motion Indicator" component={SceneViewer} argTypes={argTypes} />

export const defaultArgs = {
  source: 'aws',
  sceneId: 'MotionIndicators',
  workspaceId: 'CookieFactory',
  theme: 'dark',
  mode: 'Viewing',
  density: 'comfortable',
}

export const Template = (args) => {
  return <SceneViewer {...defaultArgs} {...args} />
}

export const MountToggle = (args) => {
  const [isMounted, setIsMounted] = useState(true)
  const toggleVisibility = useCallback(() => {
    setIsMounted(!isMounted)
  }, [isMounted])
  return (
    <div>
      <label>
        <input type="checkbox" onChange={toggleVisibility} checked={isMounted} />
          mounted
      </label>
      <div style={{ position: 'relative', height: '100vh' }}>
      { isMounted && <SceneViewer {...defaultArgs} {...args} />}
      </div>
    </div>
  )
}

## Motion Indicator

For these tests, you should authenticate against our demo aws account `540844875673`

### Verification

Motion Indicators should disappear when turned off.

#### Steps:
- Click the "View Options" Menu
- Turn off Motion Indicators

#### Verification:
- Motion Indicator should not be visible in the scene

<Canvas>
  <Story name='Motion Indicator'
    parameters={{ controls: { include: ['onSelectionChanged', 'onWidgetClick'], hideNoControlsWarning: true }}}
    args={{ ...defaultArgs, sceneComposerId: "motion-indicator-view-options" }}>
    {Template.bind({})}
  </Story>
</Canvas>

## Loading and Unloading

The scene viewer should be able to be mounted and unmounted as needed by the software application. While in production, this is discourage due to the size and complexity of this component,
during development Hot-Module-Reloaders (HMR) typically do this all the time, so the component shouldn't crash

#### Steps:
- Click the button to remount the component

#### Verification:
- It should reload without errors.

<Canvas>
  <Story name='Remounting'
    parameters={{ controls: { include: ['onSelectionChanged', 'onWidgetClick'], hideNoControlsWarning: true }}}
    args={{ ...defaultArgs, sceneComposerId: "remount-test"}}>
    {MountToggle.bind({})}
  </Story>
</Canvas>

## Editing

This test is around editing motion indicators, see if you can add a motion indicator to achieve your desired
results.

<Canvas>
  <Story name='Editing'
    parameters={{ controls: { include: ['onSelectionChanged', 'onWidgetClick'], hideNoControlsWarning: true }}}
    args={{ ...defaultArgs, sceneComposerId: "editor-test", mode: 'editing' }}>
    {Template.bind({})}
  </Story>
</Canvas>
